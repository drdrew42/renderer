%= stylesheet 'node_modules/codemirror/theme/monokai.css'
%= stylesheet 'node_modules/codemirror/theme/rubyblue.css'
%= stylesheet 'node_modules/codemirror/theme/material-palenight.css'
%= stylesheet 'node_modules/codemirror/theme/tomorrow-night-eighties.css'
%= stylesheet 'node_modules/codemirror/lib/codemirror.css'
%= javascript 'node_modules/codemirror/lib/codemirror.js'
%= javascript 'js/apps/PGCodeMirror/PG.js'

  <div id='edit-header' class='header'>
    <b>Editing problem:</b><br>
    <i><div id="currentEditPath"></div></i>
  </div>
  <div id='problem-editor' class='content'>
    %= text_area problemContentsEditor => q(Load a problem, then click on "render contents."), id => 'problemContentsEditor'
  </div>

%= javascript 'https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js'
%= javascript 'node_modules/codemirror/addon/selection/active-line.js'
%= javascript 'node_modules/codemirror/addon/edit/matchbrackets.js'
%= javascript 'node_modules/codemirror/addon/edit/closebrackets.js'
%= javascript begin
$(function(){
  cm = new CodeMirror.fromTextArea(
	  document.getElementById("problemContentsEditor"), {
	    mode: "PG",
      theme: "tomorrow-night-eighties",
      styleActiveLine: true,
	    indentUnit: 2,
	    tabMode: "spaces",
      lineNumbers: true,
	    lineWrapping: true,
      extraKeys:
        {Tab: function(cm) {cm.execCommand('insertSoftTab')}},
	    highlightSelectionMatches: true,
	    matchBrackets: true,
      closeBrackets: true,
	  });
	cm.setSize("100%","100%");
});
% end

%= stylesheet begin
#message{
  background-color:green;
}
.CodeMirror {
  border: 1px solid #eee;
  height: auto;
}
.CodeMirror * {
  font-family: Arial, monospace;
  font-size: 16px;
}
% end
